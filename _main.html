<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>MultiPAS User’s Guide</title>
  <meta name="description" content="MultiPAS User’s Guide">
  <meta name="generator" content="bookdown <!--bookdown:version--> and GitBook 2.6.7">

  <meta property="og:title" content="MultiPAS User’s Guide" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://alphonse.github.io/multipas-manual/" />
  
  
  <meta name="github-repo" content="alphonse/MultiPAS-Manual" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="MultiPAS User’s Guide" />
  
  
  

<meta name="author" content="Al Fischer">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">MultiPAS User’s Guide</h1>
<h4 class="author"><em>Al Fischer</em></h4>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#section"></a></li>
<li><a href="#safety-information"><span class="toc-section-number">1</span> Safety Information</a><ul>
<li><a href="#symbol-defintions"><span class="toc-section-number">1.1</span> Symbol Defintions</a></li>
<li><a href="#personal-safety-information"><span class="toc-section-number">1.2</span> Personal Safety Information</a></li>
<li><a href="#instrument-safety"><span class="toc-section-number">1.3</span> Instrument Safety</a></li>
</ul></li>
<li><a href="#connecting-the-instrument"><span class="toc-section-number">2</span> Connecting the Instrument</a><ul>
<li><a href="#connecting-the-control-box"><span class="toc-section-number">2.1</span> Connecting the Control Box</a></li>
<li><a href="#connecting-the-microphone"><span class="toc-section-number">2.2</span> Connecting the Microphone</a></li>
</ul></li>
<li><a href="#quick-start"><span class="toc-section-number">3</span> Quick Start</a><ul>
<li><a href="#installation"><span class="toc-section-number">3.1</span> Installation</a></li>
<li><a href="#powering-on"><span class="toc-section-number">3.2</span> Powering On</a></li>
<li><a href="#using-the-software"><span class="toc-section-number">3.3</span> Using the Software</a></li>
<li><a href="#powering-off"><span class="toc-section-number">3.4</span> Powering Off</a></li>
</ul></li>
<li><a href="#calibration"><span class="toc-section-number">4</span> Calibration</a><ul>
<li><a href="#setup"><span class="toc-section-number">4.1</span> Setup</a></li>
<li><a href="#calibration-procedure"><span class="toc-section-number">4.2</span> Calibration Procedure</a></li>
</ul></li>
<li><a href="#data-processing"><span class="toc-section-number">5</span> Data Processing</a><ul>
<li><a href="#processing-data-with-r"><span class="toc-section-number">5.1</span> Processing Data with R</a><ul>
<li><a href="#the-aero-package"><span class="toc-section-number">5.1.1</span> The aeRo Package</a></li>
<li><a href="#loading-data-into-r"><span class="toc-section-number">5.1.2</span> Loading data into R</a></li>
<li><a href="#exploring-multipas-data"><span class="toc-section-number">5.1.3</span> Exploring MultiPAS Data</a></li>
<li><a href="#processing-the-data"><span class="toc-section-number">5.1.4</span> Processing The Data</a></li>
<li><a href="#plot-data"><span class="toc-section-number">5.1.5</span> Plot data</a></li>
</ul></li>
</ul></li>
<li><a href="#flow-system"><span class="toc-section-number">6</span> Flow System</a><ul>
<li><a href="#pull-mode"><span class="toc-section-number">6.1</span> Pull Mode</a></li>
<li><a href="#push-mode"><span class="toc-section-number">6.2</span> Push Mode</a></li>
</ul></li>
<li><a href="#electrical"><span class="toc-section-number">7</span> Electrical</a></li>
<li><a href="#maintainance"><span class="toc-section-number">8</span> Maintainance</a><ul>
<li><a href="#hepa-filter-replacement"><span class="toc-section-number">8.1</span> HEPA Filter Replacement</a></li>
<li><a href="#protection-filter-replacement"><span class="toc-section-number">8.2</span> Protection Filter Replacement</a></li>
<li><a href="#cleaning-the-orifice"><span class="toc-section-number">8.3</span> Cleaning the Orifice</a></li>
<li><a href="#cleaning-the-optics"><span class="toc-section-number">8.4</span> Cleaning the Optics</a></li>
<li><a href="#cleaning-the-pas"><span class="toc-section-number">8.5</span> Cleaning the PAS</a></li>
<li><a href="#o-ring-replacement"><span class="toc-section-number">8.6</span> O-ring Replacement</a></li>
<li><a href="#fuse-replacement"><span class="toc-section-number">8.7</span> Fuse Replacement</a></li>
<li><a href="#realignment"><span class="toc-section-number">8.8</span> Realignment</a><ul>
<li><a href="#multipass-cell"><span class="toc-section-number">8.8.1</span> Multipass Cell</a></li>
<li><a href="#beam-steering-optics-and-lasers"><span class="toc-section-number">8.8.2</span> Beam Steering Optics and Lasers</a></li>
</ul></li>
</ul></li>
<li><a href="#troubleshooting"><span class="toc-section-number">9</span> Troubleshooting</a><ul>
<li><a href="#common-software-errors"><span class="toc-section-number">9.1</span> Common Software Errors</a></li>
<li><a href="#common-hardware-errors"><span class="toc-section-number">9.2</span> Common Hardware Errors</a></li>
</ul></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MultiPAS User’s Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="section" class="section level1 unnumbered">
<h1></h1>
<center>
<p><strong><em>MultiPAS-III/IV</em></strong></p>
<p><em>Multi-laser photoacoustic spectrometers</em></p>
<p><img src="images/multiPAS.png" style="display: block; margin: auto;" /></p>
© 2018 Al Fischer/Smith Lab/University of Georgia
</center>
<!--chapter:end:index.Rmd-->
</div>
<div id="safety-information" class="section level1">
<h1><span class="header-section-number">1</span> Safety Information</h1>
<p>Certain aspects of this instrument may pose a risk to the user, bystanders, and personal property. This section provides an <em>overview</em> of potential hazards, and more detail is provided within the manual body. Follow all applicable laws regarding laser operation and hazardous materials when working with the instrument.</p>
<div id="symbol-defintions" class="section level2">
<h2><span class="header-section-number">1.1</span> Symbol Defintions</h2>
<p>The following symbols indicate a potential hazard:</p>
<p><img src="images/warning_generic.png" width="50px" /> <strong>General hazard to person or instrument:</strong> This symbol indicates a potential safety hazard. Take care to avoid personal injury and/or damage to the instrument.</p>
<p><img src="images/warning_laser.png" width="50px" /> <strong>Laser radiation hazard:</strong> This symbol indicates a potential laser radiation hazard. Take care to avoid exposure to the laser beam(s) and wear eye protection if appropriate.</p>
<p><img src="images/warning_highVoltage.png" width="50px" /> <strong>Electrical shock hazard:</strong> This symbol indicates a potential electrical shock. Ensure the instrument is unplugged before continuing.</p>
</div>
<div id="personal-safety-information" class="section level2">
<h2><span class="header-section-number">1.2</span> Personal Safety Information</h2>
<p>This instrument contains visible and invisible class 3b diode lasers operating at UV, visible, and/or infrared. Direct eye or skin contact with the beam(s) may cause permament personal injury! Avoid direct eye contact with the beam and wear safety goggles of appropriate optical density when necessary! Avoid placing hands in the laser beam(s)! Be weary of wearing rings, watches, or other reflective objects that may cause erratic reflections when working in the beam. Likewise, be careful of reflections from tools that may be placed in the beam.</p>
<p>The control box for this instrument contains 120 VAC wiring. Ensure the instrument is unplugged before opening the control box for maintenance!</p>
</div>
<div id="instrument-safety" class="section level2">
<h2><span class="header-section-number">1.3</span> Instrument Safety</h2>
<p>The lasers in this instrument are <em>very</em> sensisite to optical feedback. Extreme care should be taken to avoid back reflections entering the laser aperture. Back reflections entering the laser aperture may destroy the laser diode and require purchase of a new laser head. The instrument is equipped with Faraday isolators and bandpass filters to avoid back reflections, and operating the instrument without these in place may cause permanent damage.</p>
<p>The PAS contains custom optics that may be easily scratched and dirtied. Use extreme care when handling optics and follow proper cleaning protocols.</p>
<p>The microphone uses a fiber optic cable that can be permanently damaged if bent of smashed. Handle with care.</p>
<!--chapter:end:01-safetyInformation.Rmd-->
</div>
</div>
<div id="connecting-the-instrument" class="section level1">
<h1><span class="header-section-number">2</span> Connecting the Instrument</h1>
<p>The MultiPAS consists of two primary components: (1) the optical block and (2) the control box. Both the sample and signals flow between the two components, requiring the two to be connected both hydraulically and electrically. The two components should be placed near each other on a flat, level, vibration- and sound-free surface.</p>
<p><img src="images/pasOverview.png" style="display: block; margin: auto;" /></p>
<div id="connecting-the-control-box" class="section level2">
<h2><span class="header-section-number">2.1</span> Connecting the Control Box</h2>
<ol style="list-style-type: decimal">
<li>Pass the electrical umbilical through the hole in the PAS case and connect the three SDR cables to the back of each laser; note the color code on the cables.</li>
<li><p>Connect the photodiode to the <strong>Photodiode</strong> connection on the control box with a coaxial cable via the BNC connections. Also connect the photodiode to the supplied +/-12 V power supply via the threaded, 3-pin connector.</p>
<p><img src="images/warning_highVoltage.png" width="60px" style="display: block; margin: auto;" /></p>
<blockquote>
<p><em>Ensure the appropriate mains voltage is selected on the photodiode power supply before plugging it in.</em></p>
</blockquote></li>
<li>Connect the microphone amplifier to the back of the control box with a standard 3.1 mm audio cable via the audio jacks.</li>
<li>Connect the <strong>Sample In</strong> barb on the back of the control box to the sample source (e.g. ambient air or simulation chamber). This is the sampling point.</li>
<li>Connect the <strong>Sample Out to PAS</strong> barb on the back of the control box to the <strong>Sample In</strong> barb on the PAS case.</li>
<li><p>Connect the <strong>Sample Out to Pump</strong> barb on the PAS case to the <strong>Pump In</strong> connection on the control box.</p>
<blockquote>
<p><em>The preceeding three steps are only used when the PAS is operating in “pull mode”, that is, pulling sample into the instrument. For “push mode” (e.g. when sampling from a gas cylinder) and further information regarding flows, see the chapter on the PAS flow system.</em></p>
</blockquote></li>
<li>Connect the control box to a computer via the USB-B connection on the back of the control box. <em>Note: the USB connection powers the microprocessor inside the control box; the processor remains on as long as the USB cable is plugged in</em>.</li>
<li><p>Plug the control box into the while with a three prong mains cord via the power entry module on the back of the box. The main circuitry remains off until the power switch at the cord is switched on.</p></li>
</ol>
</div>
<div id="connecting-the-microphone" class="section level2">
<h2><span class="header-section-number">2.2</span> Connecting the Microphone</h2>
<p>Follow all instructions in the OptiMic manual (supplied separately) when using the microphone.</p>
<ol style="list-style-type: decimal">
<li>Connect each prong of the fiber optic to the microphone amplifier via the bayonet connectors. The two connections are interchangeable.</li>
<li><p>Uncoil the minimum amount of fiber optic cable necessary, safely route it to the PAS, and <em>gently</em> slide the microphone into the Ultra-Torr connector on the microphone.</p>
<p><img src="images/warning_generic.png" width="60px" style="display: block; margin: auto;" /></p>
<blockquote>
<p><strong><em>The microphone can be permanently damaged if the fiber optic cable is bent or crushed!</em></strong></p>
</blockquote></li>
<li><p>Tighten the Ultra-Torr connector until <em>just</em> sealed. Even slightly over-tightening the connector can result in permanent microphone damage, but undertightening can result in a leak and/or erratic signal.</p>
<p><img src="images/warning_generic.png" width="60px" style="display: block; margin: auto;" /></p>
<blockquote>
<p><strong><em>The yellow region on the microphone body indicates the region most easily damaged by excessive force. Use extreme care when inserting the microphone!</em></strong></p>
</blockquote></li>
<li><p>If not already complete, plug the microphone into the appropriate connection on the rear panel of the control box using a 3.1 mm audio cable.</p></li>
<li><p>Plug the microphone amplifier into a 120 VAC outlet using the supplied 5V power supply. The green LED on the microphone should illuminate. You may need to turn the microphone on via the switch on the amplifier, set the noise reduction to zero via the second switch, and set the desired volume.</p></li>
</ol>
<!--chapter:end:02-connectingTheInstrument.Rmd-->
</div>
</div>
<div id="quick-start" class="section level1">
<h1><span class="header-section-number">3</span> Quick Start</h1>
<p>This section outlines the basic steps needed to start sampling with the PAS for the first time and after it has been turned off. It assumes the instrument has been connected according to <a href="connecting-the-instrument.html">Chapter 2</a>.</p>
<div id="installation" class="section level2">
<h2><span class="header-section-number">3.1</span> Installation</h2>
<ol style="list-style-type: decimal">
<li>Download or locate and install the following third-party software:
<ul>
<li><a href="http://www.ni.com/download/labview-run-time-engine-2016/6067/en/">LabVIEW run time engine</a> 2011 (National Instruments)</li>
<li><a href="https://www.zeitnitz.eu/scms/waveio">WaveIO</a> (Christian Zeitnitz)</li>
<li>OBIS Connection (supplied on USB flash drive, Coherent, Inc.)</li>
</ul></li>
<li>Locate the <a href="https://github.com/alphonse/MultiPAS-III/tree/master/exec">MultiPAS-III</a> (3 wavelengths) or <a href="https://github.com/alphonse/MultiPAS-IV/tree/master/exec">MultiPAS-IV</a> executable.</li>
<li>Connect the USB cable to the computer and let Windows install the necessary drivers.</li>
<li>Open OBIS Connection to determine the COM ports for the lasers, listed by wavelength on the left side of OBIS Connection. Write down for use in the LabVIEW program.</li>
</ol>
</div>
<div id="powering-on" class="section level2">
<h2><span class="header-section-number">3.2</span> Powering On</h2>
<ol style="list-style-type: decimal">
<li>Switch the main power on by moving the switch on the rear of the control box to the on position (“|”).</li>
<li>Open the Optical Block case with the latches on the front.</li>
<li>Ensure the laser supplies have illuminated indicators. If necessary, turn their power switches to on.</li>
<li>Open the laser apertures by sliding the knurled slider on top of the laser heads in the Optical Block case.</li>
<li>Ensure the microphone is plugged in to it’s DC power supply and it’s green LED is illuminated. Turn the switch on if necessary.</li>
<li>Turn the photodiode power supply on via the switch on the power brick. Turn the photodiode on via the switch on the side of the sensor; the green light should illuminate.</li>
<li>Remove the photodiode’s lens cap if necessary.</li>
<li>Close the case.</li>
<li>Turn the pump on by switching on the “<strong>Pump</strong>” switch on the front of the control box to begin pulling sample through the instrument.</li>
</ol>
</div>
<div id="using-the-software" class="section level2">
<h2><span class="header-section-number">3.3</span> Using the Software</h2>
<ol style="list-style-type: decimal">
<li>Open the “<strong>MultiPAS-III.exe</strong>” control program, which should start automatically. <em>Note: If COM ports have been changed, or a new computer is used you may have to stop the program and select the correct COM ports (written down during “Installation”, above) in the first tab of the UI.</em></li>
<li>Type your calibration coefficient into the appropriate box in the <em>Calibration</em> Tab to display quantitated absroption data. See the <a href="calibration.html">Calibration</a> chapter for more information.</li>
<li>Turn the lasers on by pressing <em>All Emit</em>. Alternatively, individual lasers can be turned on and off with the buttons for each laser. You should see three peaks near 1370 Hz in the FFT plots under both the <em>Microphone</em> and <em>Photodide</em> tabs.</li>
<li>To save data, click the <strong>Save</strong> button and follow the dialog prompts to use the default file location or select your own.</li>
<li>To automatically collect background spectra, select <strong>Auto Filter</strong> on the main panel of the UI. Under this setting the control box will automatically cycle between HEPA filtered air (background) and sample, and will perform frequency sweeps in between. You may set the sample time (time between filters) and background time (time for the filter and frequency sweep) to the desired time, but 24 minutes and 6 minutes are, respectively, the default and suggested values.</li>
</ol>
</div>
<div id="powering-off" class="section level2">
<h2><span class="header-section-number">3.4</span> Powering Off</h2>
<ol style="list-style-type: decimal">
<li>Press the <strong>Exit</strong> button on the main panel of the LabVIEW program. Lasers will turn off automatically. <em>NOTE: This is the only recommened way of stopping the software. Using other methods (e.g. LabVIEW’s stop sign button) may cause errors.</em></li>
<li>Open the Optical Block and turn off the photodiode and microphone. If the PAS will not be used for a while and/or to avoid dust contamination, replace the lens cap on the photodiode and slide the knurled shutter sliders on the laser to the closed position. Close the Optical Block case.</li>
<li>Turn off the main power switch on the PAS Control Box.</li>
<li>Turn off the photodiode power supply.</li>
<li>Unplug the USB cable. <em>NOTE: The main microcontroller will remain powered and continue to run while the USB cable is plugged in, regardless of the main power switch position.</em></li>
</ol>
<!--chapter:end:03-quickStart.Rmd-->
</div>
</div>
<div id="calibration" class="section level1">
<h1><span class="header-section-number">4</span> Calibration</h1>
<p>The PAS should be calibrated periodically against a standard gas mixture or a cavity ringdown spectrometer to account for the sensitivity of the cell acoustic response and microphone. By measuring a known abosrption of NO<span class="math inline">\(_2\)</span> and comparing the measured PAS signal to the known absorption, the cell constant can be determined. A standard mixture of NO<span class="math inline">\(_2\)</span> may be obtained from a specialty gas supplier (such as <a href="https://www.airgas.com/">Airgas</a>) or made quantitatively in a lab with appropriate capabilities.<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> A stock concentration of 1-10 ppm is suggested. The flow rate uncertainties dominate the total error on the PAS measurements; thus, care should be taken to select appropriate flow control devices such as to minimize uncertainties on the flow rates. The recommended calibrant is NO<span class="math inline">\(_2\)</span>.</p>
<div id="setup" class="section level2">
<h2><span class="header-section-number">4.1</span> Setup</h2>
<ol style="list-style-type: decimal">
<li>Connect the regulator to the standard NO2 cylinder and connect to the flow control and measurement device(s) compatible with NO<span class="math inline">\(_2\)</span> (e.g. a mass flow controller or rotameter). Flows will be in the 5-100 SCCM; select a flow controller accordingly.</li>
<li>Connect the outlet flow to one side of a standard <span class="math inline">\(\frac{1}{4}\)</span>&quot; T-connector with PTFE tubing.</li>
<li>Connect an N<span class="math inline">\(_2\)</span> source (e.g. a liquid nitrogen dewar, 22 psi/50 liter) to a CGA 580 regulator and then to a flow control and measurement device. Flow will be 100-300 SCCM; select device accordingly.</li>
<li>Connect the N<span class="math inline">\(_2\)</span> line to the other side of the T-connector.</li>
<li><p>Connect the third port on the T-connector to the inlet on the PAS Optical Block (i.e. <a href="file://localhost/Users/al/Dropbox/manual_MultiPAS/_book/flow-system.html#push-mode">Push Mode</a>, do NOT go through the control box). <img src="images/warning_generic.png" width="60px" style="display: block; margin: auto;" /></p>
<blockquote>
<p><strong><em>The tubing, filters, and pump inside the PAS control box can be damaged by NO<span class="math inline">\(_2\)</span>!</em></strong></p>
</blockquote></li>
</ol>
</div>
<div id="calibration-procedure" class="section level2">
<h2><span class="header-section-number">4.2</span> Calibration Procedure</h2>
<p><em>Note: The following guidelines work at 785 nm but can be adjusted to acheive the appropriate absorption for the wavelength used. For example, the absorption cross section is an order of magnitude higher at 660 nm, so nitrogen flows would increase and NO<span class="math inline">\(_2\)</span> flows would decrease to acheive absorption in the 1-100 Mm<span class="math inline">\(^{-1}\)</span> range desired. NO<span class="math inline">\(_2\)</span> cannot be accurately measured with photoacoustic methods below 420 nm.</em></p>
<ol style="list-style-type: decimal">
<li>Set the N<span class="math inline">\(_2\)</span> flow to 100 SCCM and purge the PAS for 10-15 minutes.</li>
<li>After purging with nitrogen, conduct a frequency sweep to measure the resonance frequency and set the modulation source. The resonance frequency for a cell filled with nitrogen is typically 1395-1400 Hz. After the sweep is complete, turn off all lasers except the 782 nm diode.</li>
<li>Record <span class="math inline">\(I_0\)</span> values in the calibration calculator spreadsheet. Enter the measured powers at this time, as well.</li>
<li>Open the NO<span class="math inline">\(_2\)</span> cylinder and set the flow to ~1000 SCCM for roughly 30 seconds; this allows NO<span class="math inline">\(_2\)</span> to equillibrate in the system and begin to passivate the tubing.</li>
<li>Set the NO<span class="math inline">\(_2\)</span> flow to 200 SCCM.</li>
<li>Once the PAS microphone signal is stable, record the value in the calibration calculator spreadsheet.</li>
<li>Set the NO<span class="math inline">\(_2\)</span> flow to 150 SCCM and repet the above step.</li>
<li>Repeat the above two steps until you have measured 200, 150, 100, 75, and 50 SCCM flows of NO<span class="math inline">\(_2\)</span>.</li>
<li>The slope for the calibration is typically ~100,000 V/W-cm. Enter the calculated value into the LabVIEW program in the <strong>Cell Calibration</strong> box.</li>
</ol>
<!--chapter:end:04-Calibration.Rmd-->
</div>
</div>
<div id="data-processing" class="section level1">
<h1><span class="header-section-number">5</span> Data Processing</h1>
<p>The MultiPAS system outputs two types of files during autonomous running: (1) the <code>pas.txt</code> tab-separated document containing both the raw and processed data for the PAS and (2) text files in the <code>sweeps</code> folder containing a record of each frequency sweep conducted. Although the main data file contains data that has been processed in real time, it is recommeneded that data is post-processed from the raw data prior to publication. Although data can be processed in any scientific computing or spreadhseet software, an <a href="https://www.r-project.org/about.html">R</a> package, <code>aeRo</code>, has been developed to aid in data processing and is available via <a href="https://github.com/">GitHub</a>.</p>
<div id="processing-data-with-r" class="section level2">
<h2><span class="header-section-number">5.1</span> Processing Data with R</h2>
<p>The R package <code>aeRo</code> has been developed (or rather, is currently under development) to aid in processing MultiPAS data with R.</p>
<p>R is open-source and freely available from the <a href="https://www.r-project.org/">R Project for Statistical Computing</a>. If using R, <a href="https://www.rstudio.com/products/rstudio/download/">RStudio</a>, an open-source and freely available IDE for R, is <em>highly</em> recommened for ease of using R.</p>
<div id="the-aero-package" class="section level3">
<h3><span class="header-section-number">5.1.1</span> The aeRo Package</h3>
<p>The first step to processing data in R is to install <code>aeRo</code>. The package <code>devtools</code> will be needed to install aeRo from the command line.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Install the devtools package and then load it</span>
<span class="kw">options</span>(<span class="dt">repos=</span><span class="st">&quot;http://archive.linux.duke.edu/cran/&quot;</span>) <span class="co"># not necessary if installing from </span>
<span class="co"># RStudio&#39;s package manager</span>
<span class="kw">install.packages</span>(<span class="st">&#39;devtools&#39;</span>)</code></pre></div>
<pre><code>## 
## The downloaded binary packages are in
##  /var/folders/p_/3j0qd_7s7tzdm94x3cwyj7_m0000gn/T//RtmpK9fhuF/downloaded_packages</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools)

<span class="co"># Now, use it to install aeRo and then load aeRo</span>
<span class="kw">install_github</span>(<span class="st">&#39;alphonse/aeRo&#39;</span>)
<span class="kw">library</span>(aeRo)</code></pre></div>
<p>You can see the functions available in <code>aeRo</code> by clicking on its name in the “Pacakges” tab within RStudio, executing <code>help(package = aeRo)</code>, or with the <code>ls()</code> command.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ls</span>(<span class="st">&#39;package:aeRo&#39;</span>)</code></pre></div>
<pre><code>##  [1] &quot;averagePower&quot;       &quot;averagePower.waves&quot; &quot;blockMeans&quot;        
##  [4] &quot;blockMeans.single&quot;  &quot;chooseFilterStart&quot;  &quot;compileAeth&quot;       
##  [7] &quot;convertToAbs&quot;       &quot;convertToExt&quot;       &quot;fillToLength&quot;      
## [10] &quot;fitAAE&quot;             &quot;getBg&quot;              &quot;getBg.waves&quot;       
## [13] &quot;getTau0&quot;            &quot;importAeth&quot;         &quot;importPAS&quot;         
## [16] &quot;plot.abs&quot;           &quot;plot.ssa&quot;</code></pre>
<p>More information on any command can be obtained by typing a question mark followed by the command. For example, the help file for <code>importPAS</code> is found with <code>?importPAS</code>.</p>
</div>
<div id="loading-data-into-r" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Loading data into R</h3>
<p>To load data into R, first call <code>importPAS()</code> and then subset and align the data via the graphical display to the start index of the first filter period using <code>chooseFilterStart</code>. <code>chooseFilterStart</code> requires user input to the console based on the values selected on the plot. Alternatively, if the start index is already known, you may use the argument <code>graph = FALSE</code> and <code>start = index</code> to bypass the graphical selector. The function will also make the data length a multiple of <code>period</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">setwd</span>(<span class="st">&quot;/Volumes/CHEM/Groups/Smith_G/MultiPAS-IV/ambient/20170303&quot;</span>)
pas &lt;-<span class="st"> </span><span class="kw">importPAS</span>(<span class="st">&#39;pas.txt&#39;</span>, <span class="dt">no.cols =</span> <span class="dv">18</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># chooseFilterStart()  ## typically uncommented, for graphical interface</span>
<span class="st">  </span><span class="kw">chooseFilterStart</span>(<span class="dt">graph =</span> <span class="ot">FALSE</span>, <span class="dt">start =</span> <span class="dv">1430</span>) <span class="co"># only used when start point</span>
  <span class="co">#  is already known, comment otherwise.</span></code></pre></div>
</div>
<div id="exploring-multipas-data" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Exploring MultiPAS Data</h3>
<p>The PAS outputs a tab-separated text file of the raw and processed MultiPAS data. Columns are named according to the content, with the convention Ch1 = shortest laser wavelength.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Display a few rows as an example</span>
<span class="kw">head</span>(pas)</code></pre></div>
<pre><code>##                     Time micCh1_mV micCh2_mV micCh3_mV micCh4_mV pdCh1_mV
## 1430 2017-03-03 18:39:32    22.743    11.938    7.2965    6.9984   593.96
## 1431 2017-03-03 18:39:33    22.798    11.813    7.2420    6.9810   594.03
## 1432 2017-03-03 18:39:34    22.694    11.159    6.8411    6.5995   594.05
## 1433 2017-03-03 18:39:35    22.688    10.988    6.7961    6.5283   594.12
## 1434 2017-03-03 18:39:36    21.352    10.392    6.4951    6.1681   584.84
## 1435 2017-03-03 18:39:37    21.181    10.229    6.3737    6.0705   584.75
##      pdCh2_mV pdCh3_mV pdCh4_mV    tau_sec babsCh1_Mm babsCh2_Mm
## 1430   1073.4   864.07   806.18 3.6586e-05    0.35654   -0.29381
## 1431   1072.9   863.74   806.00 3.3154e-05    0.31628   -0.99175
## 1432   1056.2   850.29   793.51 2.9407e-05    0.40930   -1.10790
## 1433   1055.5   849.70   793.08 1.7895e-05    0.23405   -1.74540
## 1434   1039.0   836.43   780.69 1.2059e-05    0.22452   -1.90810
## 1435   1038.1   835.57   780.02 2.1839e-05   -2.05710   -2.51240
##      babsCh3_Mm babsCh4_Mm bext_Mm fres_Hz filter_state elapsedTime_min
## 1430   -0.21158  -0.012408  36.964    1392            0              24
## 1431   -0.70289  -0.472130  44.498    1392            0              24
## 1432   -0.76618  -0.493860  55.666    1392            0              24
## 1433   -1.24990  -0.982410  70.830    1392            0              24
## 1434   -1.30360  -1.072700 157.160    1392            0              24
## 1435   -1.68420  -1.551100 263.900    1392            0              24</code></pre>
<p>As seen in the above snippet, the data file contains the following columns (18 total):</p>
<ol style="list-style-type: decimal">
<li><strong>Time:</strong> Sample time in the non-ambiguous UNIX/POSIX time standard, ‘YYYY-MM-DD HH:MM:SS’.</li>
<li><strong>micCh1_mV – micCh4_mV:</strong> The raw microphone signal in mV for each channel; if only 3 channels are present Ch4 will be filled with ‘0’.</li>
<li><strong>pdCh1_mV – pdCh4_mV:</strong> The raw photodiode signal in mV for each channel; if only 3 channels are present Ch4 will be filled with ‘0’.</li>
<li><strong>tau_sec:</strong> The ringdown time in seconds; for systems without a CRD, will be filled with ‘0’.</li>
<li><strong>babsCh1_Mm – babsCh4_Mm:</strong> The real-time absorption in 1/Mm for each channel; if only 3 channels are present Ch4 will be filled with ‘0’.</li>
<li><strong>bextCh1_Mm:</strong> The real-time exticntion in 1/Mm for each channel; if no CRD is present no extinction is measured and column will be filled with ‘0’.</li>
<li><strong>fres_Hz:</strong> The resonant frequency in Hz used during each sampling period.</li>
<li><strong>filter_state:</strong> A boolean indicating whether the filter is out (<code>0</code>) or inline (<code>1</code>).</li>
<li><strong>elapsedTime_min:</strong> The elapsed time in minutes since the start of the last filter; displays the maximum value during the frequency sweep.</li>
</ol>
</div>
<div id="processing-the-data" class="section level3">
<h3><span class="header-section-number">5.1.4</span> Processing The Data</h3>
<p>With <code>aeRo</code>, data can be processed by stringing together a few functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate powers, backgrounds, and tau_0, and add to main data.frame</span>
pas &lt;-<span class="st"> </span><span class="kw">cbind</span>(pas, <span class="kw">getBg</span>(pas)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="kw">averagePower</span>(pas)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="dt">tau0_s =</span> <span class="kw">getTau0</span>(pas<span class="op">$</span>tau_sec))

<span class="co"># Convert data to absorption &amp; extinction</span>
pas &lt;-<span class="st"> </span><span class="kw">cbind</span>(pas, <span class="kw">convertToAbs</span>(<span class="dt">x=</span>pas[, <span class="dv">2</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">bg=</span>pas[, <span class="dv">19</span><span class="op">:</span><span class="dv">22</span>], <span class="dt">p=</span>pas[, <span class="dv">23</span><span class="op">:</span><span class="dv">26</span>], <span class="dt">m=</span><span class="dv">114000</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">cbind</span>(<span class="dt">ext662_Mm =</span> <span class="kw">convertToExt</span>(pas<span class="op">$</span>tau_sec, pas<span class="op">$</span>tau0_s))
<span class="co"># Set background periods to NA for cleanliness in plotting</span>
pas[<span class="kw">which</span>(pas<span class="op">$</span>filter_state <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>pas<span class="op">$</span>elapsedTime_min <span class="op">&gt;</span><span class="st"> </span><span class="fl">23.5</span> <span class="op">|</span><span class="st"> </span>pas<span class="op">$</span>elapsedTime_min <span class="op">&lt;</span><span class="st"> </span><span class="fl">2.0</span>), <span class="dv">28</span><span class="op">:</span><span class="dv">32</span>] &lt;-<span class="st"> </span><span class="ot">NA</span>
<span class="co"># Add rolling average via &quot;zoo&quot; pacakge, but exlude NAs</span>
<span class="kw">library</span>(zoo)
pas[<span class="op">!</span><span class="kw">is.na</span>(pas<span class="op">$</span>abs406_Mm), <span class="dv">28</span><span class="op">:</span><span class="dv">32</span>] &lt;-<span class="st"> </span><span class="kw">rollmean</span>(<span class="kw">na.exclude</span>(pas[, <span class="dv">28</span><span class="op">:</span><span class="dv">32</span>]), <span class="dt">k =</span> <span class="dv">120</span>, <span class="dt">fill =</span> <span class="ot">NA</span>)</code></pre></div>
</div>
<div id="plot-data" class="section level3">
<h3><span class="header-section-number">5.1.5</span> Plot data</h3>
<p><code>aeRo</code> includes a plot class specifically for absorption data: <code>plot.abs()</code>. Argruments can be passed to <code>plot()</code> to change the look of the plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.abs</span>(<span class="dt">x =</span> pas<span class="op">$</span>Time, <span class="dt">y =</span> pas[, <span class="dv">28</span><span class="op">:</span><span class="dv">32</span>])</code></pre></div>
<p><img src="_main_files/figure-html/plot-1.png" width="672" /></p>
<p>Further functions for calculating AAE, SSAs, etc., are forthcoming.</p>
<!--chapter:end:05-dataProcessing.Rmd-->
</div>
</div>
</div>
<div id="flow-system" class="section level1">
<h1><span class="header-section-number">6</span> Flow System</h1>
<p>The PAS can be operated in two flow modes, “Pull Mode” (usually for aerosols) and “Push Mode” (usually for gases). A flow diagram for the PAS is shown below.</p>
<p><img src="images/flowDiagram.png" style="display: block; margin: auto;" /></p>
<div id="pull-mode" class="section level2">
<h2><span class="header-section-number">6.1</span> Pull Mode</h2>
<p>Pull Mode is recommended for normal sampling of aerosols and situations in which the sample is at ambient atmospheric pressure. In pull mode, the PAS uses an internal pump to pull sample through the instrument. In this mode, the sample is connected to the “Sample In” port on the control box (Point A). From there, it passes through a software-controlled valve to enter or bypass a HEPA filter for background measurement. It then exits the control box via the “Sample Out to PAS” port (Point B) and enters the PAS. An acoustic filter separates the PAS from downstream equipment. After leaving the optical block, the sample line re-enters the control box via the “Pump In” port (Point E). Points C and D are the ports through which the flow enters and exits the optical block enclosure. The flow is set by a flow limiting orifice under critial flow conditions. A 0.2 micron filter is placed directly after point E to protect the flow-limiting orifice and pump from particulates.</p>
<center>
<img src="images/warning_generic.png" width="50px" />
</center>
<blockquote>
<p><strong><em>The pump may be damaged by certain chemicals. Therefore, it is recommened to only use the pump for air or with adequate chemical scrubbers inline before the pump.</em></strong></p>
</blockquote>
<p>A trim-pot is located on the pump inside the control box. If the PAS is not reaching it’s desired flow, the trim-pot may be adjusted to compensate. Use a nut driver to remove the front panel and then use a screw driver to adjust the potentiometer attached to the pump just inside the front panel. The pump trim-pot is outlined in blue below.</p>
<center>
<img src="images/pumpTrimPot.jpg" width="500px" />
</center>
</div>
<div id="push-mode" class="section level2">
<h2><span class="header-section-number">6.2</span> Push Mode</h2>
<p>Push Mode is recommended for calibrations with nitrogen dioxide and when sampling other high-pressure samples. In this mode, the pressure and flow must be regulated externally from the PAS using, for example, a pressure regulator and mass flow controller. An maximum flow rate of &lt; 450 SCCM (standard cubic centimeters per minute) must be maintained to avoid turbulent flow.</p>
<blockquote>
<p><em>Flows &gt; 450 SCCM may cause excessive noise and/or overload the microphone!</em></p>
</blockquote>
<p>The flow-regulated sample is connected directly to the PAS optical block enclosure (Point C) and the exhaust is vented appropriately (e.g. to a fume hood) through point D. Note that the control box is entirely bypassed.</p>
<!--chapter:end:06-flowSystem.Rmd-->
</div>
</div>
<div id="electrical" class="section level1">
<h1><span class="header-section-number">7</span> Electrical</h1>
<center>
<img src="images/warning_highVoltage.png" width="50px" />
</center>
<blockquote>
<p><strong><em>Unplug all power before any electrical work on the PAS or opening the control box!</em></strong></p>
</blockquote>
<p>A genralized diagram of the PAS electrical system is shown below. Some components, such as photodiodes and the microphone, may require external power supplies, but the majority of the components are powered directly via the PAS control box.</p>
<p><img src="images/electricalDiagram.png" style="display: block; margin: auto;" /></p>
<p>The heart of the PAS electrical system is the Teensy 3.6 (PJRC.com) microcontroller that resides on the MultiPAS control board. The Teensy communicates with the software to control the modulation of the lasers and switch the background valve on and off. The same board distributes 12 V power to the system. The MultiPAS control board may be used with both 3- and 4-wavelength versions of the PAS. Three-wavelength versions may have a Teensy 3.2 instead of the 3.6 shown on the schematic; these are, however, mostly drop-in compatible.</p>
<p><img src="images/electricalSchematic.png" style="display: block; margin: auto;" /></p>
<!--chapter:end:07-Electrical.Rmd-->
</div>
<div id="maintainance" class="section level1">
<h1><span class="header-section-number">8</span> Maintainance</h1>
<div id="hepa-filter-replacement" class="section level2">
<h2><span class="header-section-number">8.1</span> HEPA Filter Replacement</h2>
<p>The PAS Control Box contains a Pall HEPA filter capsule used during background measurements. See the <a href="file://localhost/Users/al/Dropbox/manual_MultiPAS/_book/flow-system.html">Flow System</a> chapter for more information. This filter may need to be replaced periodically. To replace the filter:</p>
<ol style="list-style-type: decimal">
<li>Unplug the control box, remove the front and rear panels using a 1/4&quot; nut driver, and then remove the screws on the bottom of the control box and lift the top off. The filter will be immediately visible.</li>
<li>Note the orientation of the flow arrow on the filter, then disconnect the tubing from the barbed fittings on either end of the filter and slide the filter out from under the zip tie.</li>
<li>Remove the barbed fittings on either end of the old filter, remove and replace the PTFE tape on them, and install them on the new filter.</li>
<li>Slide the filter into the zip tie fastener that held the old filter. Ensure the filter is in the same orientation as the old one.</li>
<li>Replace the tubing on the 1/4&quot; barbs on either side of the filter.</li>
<li>Replace top, front, and rear panels of control box.</li>
</ol>
</div>
<div id="protection-filter-replacement" class="section level2">
<h2><span class="header-section-number">8.2</span> Protection Filter Replacement</h2>
<p>The protection filter protects the orifice and pump from particulates. It may need to be replaced periodically. To do so:</p>
<ol style="list-style-type: decimal">
<li>Unplug the control box, remove the front panel using a 1/4&quot; nut driver. The filter is behind the pump and infront of the power supply. It is a small green or purple disc.</li>
<li>Remove the filter from the attached tubing and replace with a standard 0.2 <span class="math inline">\(\mu\)</span>m Luer-lock syringe filter.</li>
<li>Replace front panel.</li>
</ol>
</div>
<div id="cleaning-the-orifice" class="section level2">
<h2><span class="header-section-number">8.3</span> Cleaning the Orifice</h2>
<p>The flow of the PAS is limited by an orifice. If it becomes clogged it may be cleaned. To clean the orifice:</p>
<ol style="list-style-type: decimal">
<li>Unplug the control box, remove the front panel using a 1/4&quot; nut driver. The orifice is behind the pump and infront of the power supply, just downstream from the protection filter. It looks like a small section of stainless steel tubing.</li>
<li>Remove the orifice from the attached tubing and note the orientation.</li>
<li>Place the orifice in a beaker of diluted laboratory detergent (e.g. Alconox), acetone, or isopropyl alcohol. Cleaning successively in each (in that order) will likely provide the best results.</li>
<li>Place the beaker in an ultrasonic cleaner for 5-10 minutes.</li>
<li>Rinse with deionized water and dry thoroughly.</li>
<li>Reinstall into the tubing inside the control box; the open side should go toward the PAS (high pressure) and the closed side toward the pump (low pressure).</li>
<li>Reinstall the front panel.</li>
</ol>
</div>
<div id="cleaning-the-optics" class="section level2">
<h2><span class="header-section-number">8.4</span> Cleaning the Optics</h2>
<p>Thor Labs lens paper (<a href="https://www.thorlabs.com/thorproduct.cfm?partnumber=MC-5">MC-5</a>) and spectrophotometric grade methanol are recommended for cleaning most optics in the PAS.</p>
</div>
<div id="cleaning-the-pas" class="section level2">
<h2><span class="header-section-number">8.5</span> Cleaning the PAS</h2>
<p>Ocassionally, aerosols may dirty the inside of the PAS. An unusally high background signal indicates the PAS needs to be cleaned.</p>
<ol style="list-style-type: decimal">
<li>Remove the PAS from the breadboard, being careful when disconnecting the tubing and microphone.</li>
<li>Remove the baseplate of the PAS.</li>
<li>Remove the windows and all fittings on the PAS. <strong><em>NOTE: The windows are custom coated and are very fragile! Use extreme caution when removing them, being sure equal tension is kept across the surface of the window (i.e. do not tighten or loosen any screw more than the others).</em></strong></li>
<li>Clean the inside of the PAS with laboratory detergent and a soft brush.</li>
<li>Rinse with acetone and/or isopropyl alcohol.</li>
<li>Rinse with deionized water.</li>
<li>Bake in an oven at 105<span class="math inline">\(^{\circ}\)</span>C for one hour or until thoroughly dry.</li>
<li>Reinstall fittings and window, being careful not to overtighten or unevenly tighten the fasteners on the windows. Reinstall the PAS baseplate, and install on the breadboard.</li>
</ol>
</div>
<div id="o-ring-replacement" class="section level2">
<h2><span class="header-section-number">8.6</span> O-ring Replacement</h2>
<p>The PAS has o-ring seals on the inlet and outlet, around the microphone, on the windows, on all other ports on the cell body, and between the main resonantor channel and end caps. These o-rings should be replaced periodically or when worn. They may be <em>very lightly</em> greased with vacuum o-ring grease prior to installation to assist in sealing and prolong o-ring life.</p>
</div>
<div id="fuse-replacement" class="section level2">
<h2><span class="header-section-number">8.7</span> Fuse Replacement</h2>
<p>The PAS contains two fuses in the power entry module on rear panel. To replace them, unplug the PAS, remove the sliding fuse holder just above the plug and replace with round 5 mm, 20 A fuses.</p>
</div>
<div id="realignment" class="section level2">
<h2><span class="header-section-number">8.8</span> Realignment</h2>
<div id="multipass-cell" class="section level3">
<h3><span class="header-section-number">8.8.1</span> Multipass Cell</h3>
<p>The multipass cell consists of two cylindrical mirrors. The cell will need tuning and alignment periodically. The alignment may be adjusted by changing the parallelism of the mirrors via the alignment knobs on either the front or rear mirror mount; it can also be adjusted by changin the relative orientation of the cylindrical cross sections of the mirrors via the rotation ring on the front mirror.</p>
<p>To align the cell from scratch:</p>
<ol style="list-style-type: decimal">
<li>Ensure all lasers are off.</li>
<li>Remove the microphone from the cell. Be careful not to damage the fiber optic cable on the mircrophone!</li>
<li>Disconnect the inlet and outlet tubing from the cell.</li>
<li>Remove the PAS screw by removing the four philips-drive screws holding it to the breadboard.</li>
<li>Turn on the green laser and click the “Alignment Mode” button in the software to set the laser power to 5 mW</li>
<li>Ensure the beam is passing through the hole in the front mirror; the small x and y adjustment knobs on the front mirror mount may be used to adjust the mirror relative to the beam.</li>
<li>Use the adjustment knobs on the back mirror to steer the beam until roughly 5 spots are observed on the back mirror.</li>
<li>Rotate the front mirror until a dense pattern of spots is observed.</li>
<li>Fine tune the alignment and rotation by maximizing the effective power read by the photodiode.</li>
</ol>
</div>
<div id="beam-steering-optics-and-lasers" class="section level3">
<h3><span class="header-section-number">8.8.2</span> Beam Steering Optics and Lasers</h3>
<p>The beam steering optics are fixed relative to each other via the cage system. If the cage system moves or must be removed, it is usually possible to place it back in the correct spot simply by aligning it such that the lasers beams pass through the hole in the front mirror (assuming the lasers have not moved).</p>
<p><em>Warning: The proceeding to the techniques listed below may require complete disassembly and realignment of the PAS!</em></p>
<p>If the lasers have moved relative to each other and the horizontal alignment is off, they may be adjusted by loosening the 1/4-20 hex-drive screws holding them to the breadboard and adjusting the angle of each laser. Keeping the screws tight enough to maintain high tension on the laser and tapping the mount gently to move it helps make fine adjustments. Adjust the angle until the beams are colinear and pass through the hole in the front mirror. This will only affect the x (horizontal) alignment.</p>
<p>If the vertical alignment is off, especially for the inner lasers, the problem is likely a misaligned dichroic. To adjust, remove the rear lens cap from the appropriate dichroic cube and tighten or loosen the screws holding the dichroic mount in the cube with a ball-end metric hex driver. Make small adjustments to steer the beam up or down. If necessary, a nylon washer may be placed under one side of the mounting plate by removing the entire cube and dissassembling it. Ideally, this alignment only affects the y (vertical) positioning, but the adjustment process might also affect the horizontal alignment.</p>
<!--chapter:end:08-maintainance.Rmd-->
</div>
</div>
</div>
<div id="troubleshooting" class="section level1">
<h1><span class="header-section-number">9</span> Troubleshooting</h1>
<div id="common-software-errors" class="section level2">
<h2><span class="header-section-number">9.1</span> Common Software Errors</h2>
<ol style="list-style-type: decimal">
<li><em>VISA Read/Write: Device not found.</em> Either the incorrect COM ports have been selected or the USB communication has frozen. In the case of the latter, exit LabVIEW completely and reset the PAS by turning off the main power switch on the control box <em>and</em> disconnecting the USB cable. Reconnect and restart.</li>
<li><em>VISA Read/Write: Device is valid but VISA cannot open it.</em> Another program is communicating with one of the PAS’s components. Close other programs and restart LabVIEW.</li>
<li><em>Valve will not switch and/or frequencies will not change.</em> USB communication broken – exit LabVIEW completely and reset the PAS by turning off the main power switch on the control box <em>and</em> disconnecting the USB cable. Reconnect and restart.</li>
<li><em>WaveIO Device Not Found.</em> Known bug with unknown cause. To fix, stop the program, increase the PD and mic device ID’s (under the Utilities tab) by 1 and start the program. Then, stop the program, set them back to their original values and start the program again. The errors should go away after the final restart.</li>
<li><em>Extremely fast aquisition (x-axis) on PD or mic plots.</em> See <em>WaveIO Device Not Found</em>, above.</li>
</ol>
</div>
<div id="common-hardware-errors" class="section level2">
<h2><span class="header-section-number">9.2</span> Common Hardware Errors</h2>
<ol style="list-style-type: decimal">
<li><em>No Signal or Excessive Noise.</em> Excessive noise or a cancellation of signal may occur if:
<ul>
<li><em>There is an opening on the PAS cell.</em> Make sure the inlet and outlet are attached to the control box, a gas line, or plugged; check all fittings on the PAS cell to ensure they are tight.</li>
<li><em>The pump is not set correctly or the orifice is missing.</em> Lower the pump speed with the trim pot on the pump and check that the orifice is in place.</li>
<li><em>The flow rate is too high.</em> Lower the flow rate.</li>
</ul></li>
<li><em>High Background.</em> The cell may be dirty. See <a href="maintainance.html#cleaning-the-pas">Cleaning the PAS</a>.</li>
<li><em>Low Laser Powers.</em> Low laser power may be observed if:
<ul>
<li><em>The multipass alignment is bad.</em> <a href="maintainance.html#realignment">Align</a> the multipass cell.</li>
<li><em>The optics are dirty.</em> <a href="maintainance.html#cleaning-the-optics">Clean the optics.</a></li>
<li><em>The optics are misaligned</em> Go through the <a href="maintainance.html#realignment">realigment</a> procedure.</li>
</ul></li>
</ol>
<!--chapter:end:09-Troubleshooting.Rmd-->
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p><a href="http://pubs.acs.org/doi/abs/10.1021/es902067h">A Sensitive and Versatile Detector for Atmospheric NO2 and NOX Based on Blue Diode Laser Cavity Ring-Down Spectroscopy</a> Hendrik Fuchs, William P. Dubé, Brian M. Lerner, Nicholas L. Wagner, Eric J. Williams, and Steven S. Brown Environmental Science &amp; Technology 2009 43 (20), 7831-7836 DOI: 10.1021/es902067h<a href="#fnref1">↩</a></p></li>
</ol>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
